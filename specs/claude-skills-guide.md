# Claude 技能格式规约

## 概述

本规约定义了 Claude 技能的标准格式和结构要求，确保技能的一致性和可维护性。

## 技能结构

### 标准目录结构

```
技能名称/
├── SKILL.md (必需)
│   ├── YAML 前置元数据 (必需)
│   │   ├── name: (必需)
│   │   └── description: (必需)
│   └── Markdown 指令 (必需)
└── 捆绑资源 (可选)
    ├── scripts/          - 可执行代码 (Python/Bash/Node.js 等)
    ├── references/       - 文档，按需加载到上下文中
    └── assets/           - 输出中使用的文件 (模板、图标、字体等)
```

## SKILL.md 文件规范

### YAML 前置元数据要求

**必需字段：**
- `name`: 技能名称（连字符格式，小写字母、数字和连字符）
- `description`: 技能描述（明确说明技能用途和触发场景）

**可选字段：**
- `license`: 许可证信息
- `version`: 版本号
- `author`: 作者信息

**命名规范：**
- 使用连字符格式：`my-skill-name`
- 仅包含小写字母、数字和连字符
- 不能以连字符开头或结尾
- 不能包含连续连字符
- 最大长度：40 个字符

**描述规范：**
- 使用第三人称描述（"此技能应在...时使用"）
- 明确说明触发场景和适用条件
- 不能包含尖括号（< 或 >）
- 应具体说明技能的功能和使用时机

### Markdown 内容规范

**写作风格：**
- 使用**命令式/不定式**（动词优先的指令）
- 避免使用第二人称（"你应该..."）
- 使用客观、指导性语言
- 示例："要完成 X，请执行 Y" 而不是 "你应该做 X"

**内容结构建议：**

#### 1. 工作流型（适用于顺序流程）
- 适用于有明确步骤的程序
- 结构：## 概述 → ## 工作流决策树 → ## 步骤 1 → ## 步骤 2...

#### 2. 任务型（适用于工具集合）
- 适用于技能提供不同操作/能力
- 结构：## 概述 → ## 快速开始 → ## 任务类别 1 → ## 任务类别 2...

#### 3. 参考/指南型（适用于标准或规范）
- 适用于品牌指南、编码标准或需求
- 结构：## 概述 → ## 指南 → ## 规范 → ## 使用...

#### 4. 能力型（适用于集成系统）
- 适用于技能提供多个相互关联的功能
- 结构：## 概述 → ## 核心能力 → ### 1. 功能 → ### 2. 功能...

## 捆绑资源规范

### scripts/ 目录

**用途：** 可执行代码（Python/Bash/Node.js 等），用于需要确定性可靠性或重复编写的任务。

**适用场景：**
- 相同代码被重复编写时
- 需要确定性可靠性时
- 自动化、数据处理或特定操作

**文件规范：**
- 使用适当的文件扩展名（.py, .sh, .js, .mjs 等）
- 包含可执行权限（如适用）
- 提供清晰的文档字符串或注释
- 包含错误处理

**示例：**
- `scripts/rotate_pdf.py` - PDF 旋转任务（Python）
- `scripts/document.py` - 文档处理模块（Python）
- `scripts/process_data.js` - 数据处理脚本（Node.js）
- `scripts/build_template.mjs` - 模板构建工具（Node.js ES模块）

### references/ 目录

**用途：** 文档和参考资料，按需加载到上下文中以指导 Claude 的流程和思考。

**适用场景：**
- Claude 在工作时应参考的文档
- 数据库模式、API 文档、领域知识
- 公司政策、详细工作流指南
- 信息量过大不适合放在 SKILL.md 中的内容

**最佳实践：**
- 避免重复：信息应位于 SKILL.md 或参考文件中，不要同时存在
- 保持 SKILL.md 精简，将详细参考材料移至参考文件
- 如果文件较大（>10k 字），在 SKILL.md 中包含 grep 搜索模式

**示例：**
- `references/finance.md` - 财务模式
- `references/api_docs.md` - API 规范
- `references/policies.md` - 公司政策

### assets/ 目录

**用途：** 不打算加载到上下文中的文件，而是在 Claude 产生的输出中使用。

**适用场景：**
- 技能需要用于最终输出的文件
- 模板、样板代码、文档模板
- 图像、图标、字体
- 要复制或使用的文件

**文件类型：**
- 模板：.pptx, .docx, 样板目录
- 图像：.png, .jpg, .svg, .gif
- 字体：.ttf, .otf, .woff, .woff2
- 样板代码：项目目录、启动文件
- 数据文件：.csv, .json, .xml, .yaml

**示例：**
- `assets/logo.png` - 品牌资源
- `assets/slides.pptx` - PowerPoint 模板
- `assets/frontend-template/` - HTML/React 样板

## 渐进式披露设计原则

技能使用三级加载系统来有效管理上下文：

1. **元数据（名称 + 描述）** - 始终在上下文中（约 100 字）
2. **SKILL.md 主体** - 技能触发时（<5k 字）
3. **捆绑资源** - 按 Claude 需要（无限*）

*无限是因为脚本可以在不读入上下文窗口的情况下执行。

## 技能创建流程

### 步骤 1：通过具体示例理解技能

**目标：** 明确技能的使用模式和触发条件

**关键问题：**
- 技能应支持什么功能？
- 技能的使用示例是什么？
- 用户说什么会触发此技能？

### 步骤 2：规划可重复使用的技能内容

**分析每个示例：**
1. 考虑如何从头开始执行示例
2. 识别在执行这些工作流时哪些脚本、参考和资源会有帮助

**建立技能内容列表：**
- 脚本：需要确定性可靠性的代码
- 参考：需要参考的详细文档
- 资源：输出中使用的文件

### 步骤 3：初始化技能

**使用初始化脚本：**
```bash
python scripts/init_skill.py <skill-name> --path <output-directory>
```

**默认保存位置：**
- 技能目录默认保存在 `.claude/skills/` 目录下
- 如果未指定 `--path` 参数，将在 `.claude/skills/<skill-name>/` 创建技能
- 可通过 `--path` 参数自定义输出目录

**脚本功能：**
- 在指定路径（或默认的 `.claude/skills/` 目录）创建技能目录
- 生成带有适当前置元数据和 TODO 占位符的 SKILL.md 模板
- 创建示例资源目录：`scripts/`、`references/`、`assets/`
- 在每个目录中添加可自定义或删除的示例文件

### 步骤 4：编辑技能

**重点：** 为另一个 Claude 实例创建技能

**编辑顺序：**
1. 从可重复使用的资源开始：`scripts/`、`references/`、`assets/`
2. 删除不需要的示例文件和目录
3. 更新 SKILL.md

**SKILL.md 完成检查：**
1. 技能的目的是什么？（几句话）
2. 何时应使用技能？
3. 在实践中，Claude 应如何使用技能？

### 步骤 5：打包技能

**使用打包脚本：**
```bash
python scripts/package_skill.py <path/to/skill-folder>
```

**验证检查：**
- YAML 前置元数据格式和必需字段
- 技能命名约定和目录结构
- 描述完整性和质量
- 文件组织和资源引用

**打包结果：**
- 创建以技能命名的 zip 文件（例如 `my-skill.zip`）
- 包含所有文件并保持适当的目录结构

### 步骤 6：迭代

**迭代工作流：**
1. 在实际任务中使用技能
2. 注意困难或低效之处
3. 识别 SKILL.md 或捆绑资源应如何更新
4. 实施更改并再次测试

## 验证要求

### 基本验证

1. **SKILL.md 存在性** - 必需文件
2. **YAML 前置元数据** - 正确格式和必需字段
3. **命名约定** - 连字符格式，仅小写字母、数字和连字符
4. **描述质量** - 不含尖括号，明确说明使用场景

### 高级验证（打包时）

1. **目录结构** - 符合标准组织
2. **资源引用** - SKILL.md 中正确引用捆绑资源
3. **文件组织** - 资源正确分类到相应目录

## 最佳实践

### 元数据质量
- 名称和描述决定 Claude 何时使用技能
- 具体说明技能功能和何时使用
- 使用第三人称描述

### 资源组织
- **脚本** - 用于确定性可靠性和重复操作
- **参考** - 用于详细文档按需加载
- **资源** - 用于输出文件（模板、图像、字体）

### 工作流集成
- 技能应与文档处理管道集成
- 支持 OOXML 文档操作
- 支持文本提取和分析
- 支持基于模板的文档生成
- 支持质量验证和确认

## 示例

### 有效技能名称
- `data-analyzer`
- `pdf-editor`
- `frontend-builder`
- `api-helper`

### 无效技能名称
- `DataAnalyzer`（应使用连字符）
- `my_skill`（应使用连字符而非下划线）
- `-skill-name`（不能以连字符开头）
- `skill--name`（不能包含连续连字符）

### 有效描述示例
> "此技能应在用户需要处理 PDF 文档时使用，包括旋转、合并和提取文本操作。"

### 无效描述示例
> "使用此技能来<处理PDF>"（包含尖括号）

---

**文档版本：** 1.0
**最后更新：** 2025-10-30
**基于：** skill-creator 技能和验证脚本